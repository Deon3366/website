<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Deon â€” Under Construction</title>
  <meta name="color-scheme" content="light dark" />
  <style>
    :root{--bg:#0b0d10;--panel:#12151a;--text:#e6edf3;--muted:#9aa4af;--brand:#7c61ff;--accent:#21d4fd;--radius:16px;--shadow:0 10px 30px rgba(0,0,0,.35)}
    @media(prefers-color-scheme:light){:root{--bg:#f6f8fb;--panel:#fff;--text:#0b0d10;--muted:#57606a;--brand:#5b43ff;--accent:#0086ff;--shadow:0 10px 30px rgba(0,0,0,.08)}}
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial;color:var(--text);background:
      radial-gradient(1200px 600px at 85% -10%,rgba(124,97,255,.25),transparent 60%),
      radial-gradient(900px 500px at -10% 20%,rgba(33,212,253,.18),transparent 60%),var(--bg)}
    a{color:inherit;text-decoration:none}
    .container{max-width:1080px;margin:0 auto;padding:32px}
    header{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:8px 0 24px}
    .logo{display:flex;align-items:center;gap:12px;font-weight:700;font-size:18px}
    .logo-mark{width:32px;height:32px;border-radius:10px;background:linear-gradient(135deg,var(--brand),var(--accent));box-shadow:var(--shadow)}
    nav a{margin-right:16px}
    .banner{text-align:center;padding:12px;background:linear-gradient(90deg,var(--brand),var(--accent));color:#fff;font-weight:600;border-radius:var(--radius);margin-bottom:24px}
    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:18px}
    @media(max-width:900px){.grid{grid-template-columns:1fr}}
    .card{background:var(--panel);border:1px solid rgba(255,255,255,.08);padding:22px;border-radius:var(--radius);box-shadow:var(--shadow)}
    @media(prefers-color-scheme:light){.card{background:#fff;border-color:#eee}}
    .muted{color:var(--muted)}
    ul.feed{list-style:none;padding-left:0;margin:10px 0 0}
    ul.feed li{margin:0 0 10px}
    .small{font-size:13px}
    footer{margin:40px 0 8px;color:var(--muted);font-size:14px;text-align:center}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;background:linear-gradient(135deg,var(--brand),var(--accent));color:white;font-weight:600;box-shadow:var(--shadow)}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,.12);color:var(--text)}
    @media(prefers-color-scheme:light){.btn.ghost{border-color:rgba(0,0,0,.12)}}
  </style>
</head>
<body>
  <div class="container">
    <div class="banner">ðŸš§ UNDER CONSTRUCTION â€” main site is being built. In the meantime, here are fresh UK security headlines.</div>

    <header>
      <div class="logo"><div class="logo-mark"></div> Deon</div>
      <nav>
        <a href="about.html">About</a>
        <a href="news.html">News</a>
        <a href="#contact">Contact</a>
      </nav>
    </header>

    <section id="feeds" class="grid">
      <article class="card">
        <h2 style="margin-top:0">BBC â€” Technology</h2>
        <ul id="feed-bbc" class="feed"><li class="muted">Loadingâ€¦</li></ul>
        <div class="small muted">Source: BBC News</div>
      </article>
      <article class="card">
        <h2 style="margin-top:0">The Register â€” Security</h2>
        <ul id="feed-reg" class="feed"><li class="muted">Loadingâ€¦</li></ul>
        <div class="small muted">Source: The Register</div>
      </article>
    </section>

    <section id="contact" class="card">
      <h2>Contact</h2>
      <p class="muted">Replace the links with your real profiles.</p>
      <p>
        <a class="btn ghost" href="https://www.linkedin.com/in/deon-ludeke/" target="_blank" rel="noopener">LinkedIn</a>
        <a class="btn ghost" href="https://discord.com/users/deon3366" target="_blank" rel="noopener">Discord</a>
      </p>
    </section>

    <footer>Â© <span id="year"></span> Deon â€¢ Built with HTML/CSS â€¢ Deployed via Cloudflare Pages</footer>
  </div>

  <script>
    (function () {
      // 1) Update footer year
      const yearEl = document.getElementById('year');
      if (yearEl) yearEl.textContent = new Date().getFullYear();

      // 2) Helper functions
      const $ = (id) => document.getElementById(id);
      const setFail = (id, msg) => { const el = $(id); if (el) el.innerHTML = `<li class="muted">${msg}</li>` };

      // 3) Load feeds
      async function loadFeeds() {
        try {
          const r = await fetch('/api/feeds', { headers: { accept: 'application/json' } });
          if (!r.ok) throw new Error(`HTTP ${r.status}`);
          const json = await r.json();
          if (!json || !Array.isArray(json.feeds)) throw new Error('Bad JSON structure');

          const by = (needle) => json.feeds.find(f => (f.source || '').toLowerCase().includes(needle)) || { items: [] };

          const render = (id, items) => {
            const el = $(id);
            if (!el) return;
            el.innerHTML = (items || []).map(i => {
              const t = (i.title || '').replace(/"/g,'&quot;');
              const l = (i.link || '#');
              const d = i.date ? new Date(i.date).toLocaleString() : '';
              return `<li><a href="${l}" target="_blank" rel="noopener">${t}</a><div class="small muted">${d}</div></li>`;
            }).join('') || '<li class="muted">No items.</li>';
          };

          const bbc = by('bbc');
          const reg = by('register');

          render('feed-bbc', bbc.items);
          render('feed-reg', reg.items);
        } catch (err) {
          console.error('Feed load error:', err);
          setFail('feed-bbc', 'Failed to load.');
          setFail('feed-reg',  'Failed to load.');
        }
      }

      // 4) Trigger load
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadFeeds);
      } else {
        loadFeeds();
      }

      // 5) Failsafe timeout
      setTimeout(() => {
        ['feed-bbc','feed-reg'].forEach(id => {
          const el = $(id);
          if (el && /Loading/i.test(el.textContent)) setFail(id, 'Timeout loading.');
        });
      }, 8000);
    })();
  </script>
</body>
</html>
